### 5. è®Šæ•¸è³‡æ–™å„²å­˜èˆ‡ä½œç”¨åŸŸstorage/memory/calldata

- Solidityä¸­çš„å¼•ç”¨
å¼•ç”¨é¡å‹(Reference Type)ï¼š
    - åŒ…å«é™£åˆ—ï¼ˆarrayï¼‰å’Œçµæ§‹é«”ï¼ˆstructï¼‰ï¼Œç”±æ–¼é€™é¡è®Šæ•¸è¼ƒç‚ºè¤‡é›œï¼Œä½”ç”¨å„²å­˜ç©ºé–“å¤§ï¼Œæˆ‘å€‘åœ¨ä½¿ç”¨æ™‚å¿…é ˆå®£å‘Šè³‡æ–™å„²å­˜çš„ä½ç½®ã€‚

æ•¸æ“š
Solidityè³‡æ–™å„²å­˜ä½ç½®æœ‰ä¸‰é¡ï¼šstorageï¼Œmemoryå’Œcalldataã€‚ä¸åŒå„²å­˜ä½ç½®çš„gasæˆæœ¬ä¸åŒã€‚storageé¡å‹çš„è³‡æ–™å­˜åœ¨éˆä¸Šï¼Œé¡ä¼¼é›»è…¦çš„ç¡¬ç¢Ÿï¼Œæ¶ˆè€—gaså¤šï¼›memoryå’Œcalldataé¡å‹çš„è‡¨æ™‚å­˜åœ¨è¨˜æ†¶é«”è£¡ï¼Œæ¶ˆè€—gaså°‘ã€‚å¤§è‡´ç”¨æ³•ï¼š

- storageï¼šåˆç´„è£¡çš„ç‹€æ…‹è®Šæ•¸é è¨­éƒ½æ˜¯storageï¼Œå„²å­˜åœ¨éˆä¸Šã€‚

- memoryï¼šå‡½æ•¸è£¡çš„åƒæ•¸å’Œè‡¨æ™‚è®Šæ•¸ä¸€èˆ¬ç”¨ memoryï¼Œå„²å­˜åœ¨è¨˜æ†¶é«”ä¸­ï¼Œä¸ä¸ŠéŠã€‚å°¤å…¶æ˜¯å¦‚æœå‚³å›è³‡æ–™å‹åˆ¥æ˜¯è®Šé•·çš„æƒ…æ³ä¸‹ï¼Œå¿…é ˆåŠ ä¸Š memoryä¿®é£¾ï¼Œä¾‹å¦‚ï¼šstring, bytes, arrayå’Œè‡ªè¨‚çµæ§‹ã€‚

- calldataï¼šå’Œmemoryé¡ä¼¼ï¼Œå„²å­˜åœ¨è¨˜æ†¶é«”ä¸­ï¼Œä¸ä¸ŠéŠã€‚èˆ‡ memoryçš„ä¸åŒé»åœ¨æ–¼calldataè®Šæ•¸ä¸èƒ½ä¿®æ”¹ï¼ˆimmutableï¼‰ï¼Œä¸€èˆ¬ç”¨æ–¼å‡½æ•¸çš„åƒæ•¸ã€‚ä¾‹å­ï¼š
```solidity
function fCalldata(uint[] calldata _x) public pure returns(uint[] calldata){
    //å‚æ•°ä¸ºcalldataæ•°ç»„ï¼Œä¸èƒ½è¢«ä¿®æ”¹
    // _x[0] = 0 //è¿™æ ·ä¿®æ”¹ä¼šæŠ¥é”™
    return(_x);
}
```
ğŸ§‘â€ğŸ’» `ä¹Ÿå°±æ˜¯èªª calldata åˆ° function è£¡é¢æ™‚æ˜¯ä¸å¯ä»¥è¢«ä¿®æ”¹çš„ã€‚`

#### Storage ç¯„ä¾‹
```solidity
uint[] x = [1,2,3]; // çŠ¶æ€å˜é‡ï¼šæ•°ç»„ x

function fStorage() public{
    uint[] storage xStorage = x;
    xStorage[0] = 100;
}
```

ğŸ§‘â€ğŸ’» ä¸Šé¢å¯ä»¥çœ‹åˆ° `storage` çš„è®Šæ•¸ xStorage æ˜¯æŒ‡å‘ x çš„ï¼Œæ‰€ä»¥ä¿®æ”¹ xStorage ä¹Ÿæœƒå½±éŸ¿åˆ° xã€‚

ğŸ§‘â€ğŸ’» å¦‚æœç”¨ä¸Šéˆä¸Šè³‡æ–™éƒ½æ˜¯å¾ˆèŠ± gas fee

#### å…¨åŸŸè®Šæ•¸-ä»¥å¤ªå–®ä½èˆ‡æ™‚é–“

Solidityä¸­ä¸å­˜åœ¨å°æ•¸é»ï¼Œä»¥0ä»£æ›¿ç‚ºå°æ•¸é»
- ä»¥å¤ªå–®ä½
  - wei: 1
  - gwei: 1e9 = 1000000000
  - etherï¼š 1e18 = 1000000000000000000
- æ™‚é–“
  - seconds: 1
  - minutesï¼š 60 ç§’ = 60
  - hoursï¼š 60 åˆ†é˜ = 3600
  - daysï¼š24å°æ™‚=86400
  - weeksï¼š7å¤©=604800


æœ¬ç« é‡é»ï¼š

é‡é»æ˜¯storage,memoryå’Œcalldataä¸‰å€‹é—œéµå­—çš„ç”¨æ³•ã€‚ä»–å€‘å‡ºç¾çš„åŸå› æ˜¯ç‚ºäº†ç¯€çœéˆä¸Šæœ‰é™çš„å„²å­˜ç©ºé–“å’Œé™ä½ gas

### 6. å¼•ç”¨å‹, array, struct

`æˆ‘å€‘å°‡ä»‹ç´¹Solidityä¸­å…©å€‹é‡è¦çš„è®Šæ•¸é¡å‹ï¼šé™£åˆ—ï¼ˆarrayï¼‰å’Œçµæ§‹é«”ï¼ˆstructï¼‰ã€‚`
- æ•¸çµ„ï¼ˆArray)

  å›ºå®šé•·åº¦é™£åˆ—
  ```
  // å›ºå®šé•·åº¦ Array
  uint[8] array1;
  bytes1[5] array2;
  address[100] array3;
  ```
  å¯è®Šé•·åº¦é™£åˆ—
  ```
    uint[] array4;
    bytes1[] array5;
    address[] array6;
    bytes array7;
  ```
  æ³¨æ„ï¼šbytesæ¯”è¼ƒç‰¹æ®Šï¼Œæ˜¯æ•¸çµ„ï¼Œä½†ä¸ç”¨åŠ []ã€‚
  
  å¦å¤–ï¼Œä¸èƒ½ç”¨byte[]è²æ˜å–®å­—ç¯€æ•¸çµ„ï¼Œå¯ä»¥ä½¿ç”¨bytesæˆ–bytes1[]ã€‚
  
  bytesæ¯”bytes1[]çœgasã€‚

  åœ¨Solidityè£¡ï¼Œå‰µå»ºæ•¸çµ„æœ‰ä¸€äº›è¦å‰‡ï¼š

  å°æ–¼memoryä¿®é£¾çš„åŠ¨æ€æ•°ç»„ï¼Œå¯ä»¥ç”¨newæ“ä½œç¬¦ä¾†å‰µå»ºï¼Œä½†æ˜¯å¿…é ˆè²æ˜é•·åº¦ï¼Œä¸¦ä¸”è²æ˜å¾Œé•·åº¦ä¸èƒ½æ”¹è®Šã€‚ä¾‹å­ï¼š
  ```
    // memory å‹•æ…‹æ•¸çµ„
    uint[] memory array8 = new uint[](5);
    bytes memory array9 = new bytes(9);
    // è³¦å€¼
    uint[] memory x = new uint[](3);
    x[0] = 1;
    x[1] = 3;
    x[2] = 4;

    // length: é™£åˆ—æœ‰ä¸€å€‹åŒ…å«å…ƒç´ æ•¸é‡çš„lengthæˆå“¡ï¼Œmemoryé™£åˆ—çš„é•·åº¦åœ¨å»ºç«‹å¾Œæ˜¯å›ºå®šçš„ã€‚
    // push():åŠ¨æ€æ•°ç»„æ“æœ‰push()æˆå“¡ï¼Œå¯ä»¥åœ¨é™£åˆ—æœ€å¾ŒåŠ ä¸Šä¸€å€‹0å…ƒç´ ï¼Œä¸¦å‚³å›è©²å…ƒç´ çš„åƒè€ƒã€‚
    // push(x):åŠ¨æ€æ•°ç»„æ“æœ‰push(x)æˆå“¡ï¼Œå¯ä»¥åœ¨é™£åˆ—æœ€å¾ŒåŠ ä¸Šä¸€å€‹xå…ƒç´ ã€‚
    // pop():åŠ¨æ€æ•°ç»„æ“æœ‰pop()æˆå“¡ï¼Œå¯ä»¥ç§»é™¤é™£åˆ—æœ€å¾Œä¸€å€‹å…ƒç´ ã€‚

  ```

- çµæ§‹é«”ï¼ˆStructï¼‰

example:
```
struct Student{
    uint256 id;
    uint256 score; 
}

Student student; // åˆå§‹ä¸€ä¸ªstudent çµæ§‹é«”
```

çµ¦å€¼çš„æ–¹æ³•ï¼š
```
// 1
function initStudent1() external{
    // assign a copy of student
    Student storage _student = student;
    _student.id = 11;
    _student.score = 100;
}
// 2
function initStudent2() external{
    student.id = 1;
    student.score = 80;
}
// 3
function initStudent3() external {
    student = Student(3, 90);
}
// 4
function initStudent4() external {
    student = Student({id: 4, score: 60});
}
```